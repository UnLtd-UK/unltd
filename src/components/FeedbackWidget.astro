<div x-data="{ open: false, feedbackType: '', message: '', screenshot: null }">
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer
  ></script>
  <button
    @click="open = true"
    class="cursor-pointer inline-flex items-center gap-x-1.5 rounded-md border border-violet-600 bg-violet-900 px-2.5 py-1.5 text-xs font-semibold text-violet-50 shadow-xs hover:bg-violet-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-violet-600"
  >
    Give us feedback
  </button>

  <div x-show="open" x-cloak x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 scale-90" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="transition ease-in duration-300" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-90" class="fixed inset-0 flex items-center justify-center backdrop-blur-sm">
    <form action="https://form.unltd.workers.dev/" method="POST" enctype="multipart/form-data" class="bg-white rounded-lg p-6 w-full max-w-md">
      <h2 class="text-lg font-semibold mb-4">Submit Feedback</h2>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Name</label>
        <input name="name" type="text" class="p-2 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 sm:text-sm"/>
      </div>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Email</label>
        <input name="email" type="email" class="p-2 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 sm:text-sm"/>
      </div>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Feedback Type</label>
        <select name="feedbacktype" x-model="feedbackType" class="p-2 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 sm:text-sm">
          <option value="">Select...</option>
          <option value="issue">Issue</option>
          <option value="feature">Feature</option>
          <option value="other">Other</option>
        </select>
      </div>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Message</label>
        <textarea name="message" x-model="message" rows="4" class="p-2 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 sm:text-sm"></textarea>
      </div>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Screenshot</label>
        <input name="screenshot" type="file" @change="screenshot = $event.target.files[0]" class="cursor-pointer mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100"/>
      </div>
      <input type="hidden" name="pageUrl" :value="window.location.href">
      <div class="cf-turnstile" data-sitekey="0x4AAAAAAA7WX5YoqLQOPiIW"></div>

      <div class="flex justify-end">
        <button type="button" @click="open = false" class="cursor-pointer mr-2 inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500">
          Cancel
        </button>
        <button type="submit" class="cursor-pointer inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-violet-600 hover:bg-violet-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500">
          Submit
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  function submitFeedback() {
    // Implement the logic to send feedback using Resend API
    // You can access feedbackType, message, and screenshot from Alpine JS state
  }
</script>
