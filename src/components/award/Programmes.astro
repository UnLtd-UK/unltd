---
import { programmes } from "../../data/programmes.js";
import { services } from "../../data/services.js";
import truncate from "truncate";

import Programme from "../../components/award/Programme.astro";
import { Description } from "../catalyst/fieldset";
import { sesm } from "../../data/sesm.js";

programmes.map((programme) => {
  const slugify = (text) =>
    text
      .toString()
      .normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "")
      .toLowerCase()
      .trim()
      .replace(/\s+/g, "-")
      .replace(/[^\w-]+/g, "")
      .replace(/--+/g, "-");

  programme.slug = slugify(programme.name);
});
---

<div class="mx-auto max-w-7xl px-6 lg:px-8 flex flex-col gap-5">
  <div class="mx-auto max-w-2xl lg:text-center">
    <h1
      class="text-base font-semibold leading-7 text-amber-600 dark:text-amber-500"
    >
      Support
    </h1>
    <p
      class="mt-2 text-4xl font-bold tracking-tight text-slate-900 dark:text-slate-100 sm:text-5xl"
    >
      Your programme
    </p>
    <p
      class="mx-auto mt-6 max-w-2xl text-center text-lg leading-8 text-slate-600 dark:text-slate-400"
    >
      Based on your age, geography and sectors you're working in, you'll be
      placed on one of our programmes. Programmes make sure our services are
      specialised to match you and your social enterprises needs.
    </p>
  </div>

  <div>
    <!-- support programmes -->
    <div class="flex flex-col gap-20">
      <div
        class="mx-auto mt-16 max-w-2xl gap-6 sm:mt-20 lg:mx-0 lg:max-w-none flex flex-col"
      >
        <div class="flex gap-6 justify-center flex-col lg:flex-row">
          <article
            class="relative isolate flex flex-col gap-4 justify-end overflow-hidden rounded-2xl outline-slate-200 w-full px-8 py-10 md:w-1/3 outline-dashed outline-2 outline-offset-2"
          >
            <div>
              <span class="relative inline-block">
                <div
                  class={`flex items-center justify-center h-14 w-14 rounded-md bg-amber-600`}
                >
                  <i class="fa-solid fa-award-simple text-amber-200 text-2xl"
                  ></i>
                </div>
              </span>
              <h3
                class={`mt-3 font-semibold leading-6 text-slate-800 dark:text-slate-200`}
              >
                <span class="absolute inset-0"></span>
                <p class="text-lg">Core</p>
              </h3>
              <p class={`text-slate-700 dark:text-slate-300 text-sm`}>
                {truncate("Funded by the Millennium Awards Trust", 100)}
              </p>
            </div>

            <div class="flex flex-col gap-3">
              <div>
                <p
                  class={`truncate text-xs font-medium text-slate-400 uppercase`}
                >
                  <i class={`fa-solid fa-spinner text-slate-500`}></i>{" "}
                  Age
                </p>
                <p
                  class={`mt-1 text-base font-semibold tracking-tight text-slate-500`}
                >
                  16+
                </p>
              </div>
              <div>
                <p
                  class={`truncate text-xs font-medium text-slate-400 uppercase`}
                >
                  <i class={`fa-solid fa-location-dot text-slate-500`}></i>
                  Geography
                </p>
                <p
                  class={`mt-1 text-base font-semibold tracking-tight text-slate-500`}
                >
                  United Kingdom
                </p>
              </div>
              <div>
                <p
                  class={`truncate text-xs font-medium text-slate-400 uppercase`}
                >
                  <i class={`fa-solid fa-vector-square text-slate-500`}></i>{
                    " "
                  }
                  Sectors
                </p>
                <p
                  class={`mt-1 text-base font-semibold tracking-tight text-slate-500`}
                >
                  All sectors
                </p>
              </div>
            </div>
          </article>
          {
            programmes.map(
              (programme, i) =>
                i < 2 && (
                  <Programme
                    image={programme.image.id}
                    icon={programme.icon}
                    colour={programme.colour}
                    name={programme.name}
                    blurb={programme.blurb}
                    slug={programme.slug}
                    age={programme.age}
                    geography={programme.geography}
                    sectors={programme.sectors}
                  />
                ),
            )
          }
        </div>
        <div class="flex gap-6 justify-center flex-col md:flex-row">
          {
            programmes.length >= 2 &&
              programmes.map(
                (programme, i) =>
                  i >= 2 && (
                    <Programme
                      image={programme.image.id}
                      icon={programme.icon}
                      colour={programme.colour}
                      name={programme.name}
                      blurb={programme.blurb}
                      slug={programme.slug}
                      age={programme.age}
                      geography={programme.geography}
                      sectors={programme.sectors}
                      size="w-9"
                    />
                  ),
              )
          }
        </div>
      </div>
    </div>

    <!-- support services -->
    <div
      class="mx-auto grid max-w-2xl grid-cols-1 gap-x-8 gap-y-16 sm:gap-y-20 lg:mx-0 lg:max-w-none lg:grid-cols-3"
    >
      <div class="basis-2/6 flex flex-col gap-2">
        <h2
          class="text-3xl font-bold tracking-tight text-slate-900 sm:text-4xl"
        >
          Services
        </h2>
        <p class="text-slate-500">
          UnLtd supports social entrepreneurs who are tackling a range of social
          or environmental issues. If your application fits either of these
          areas, a dedicated team will handle your application and support.
        </p>
        <div class="flex -space-x-2 overflow-hidden">
          {
            sesm.map((employee) => (
              <img
                class="inline-block h-10 w-10 rounded-full ring-2 ring-slate-200 dark:ring-slate-800"
                src={`https://unltd.directus.app/assets/${employee.person.image}`}
                alt={`${employee.person.name}`}
              />
            ))
          }
        </div>
      </div>

      <div class="col-span-2 grid grid-cols-1 gap-x-4 gap-y-4 sm:grid-cols-2">
        {
          services.map((service) => (
            <div class="flex-1 relative isolate flex flex-col justify-end overflow-hidden rounded-2xl p-8 gap-4">
              <dt class="text-base font-semibold leading-7 text-slate-900 dark:text-slate-100">
                <div class="mb-6 flex h-10 w-10 items-center justify-center rounded-full bg-slate-200 dark:bg-slate-800">
                  <i
                    class={`${service.icon} text-slate-500 dark:text-slate-400 text-md`}
                  />
                </div>
                {service.name}
              </dt>
              <dd class="mt-1 text-base leading-7 text-slate-600 dark:text-slate-400">
                {service.description}
              </dd>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</div>
