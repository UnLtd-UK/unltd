---
const { styles, name, posts } = Astro.props;
import Container from "@components/Container.astro";
import slugify from "slugify";
import moment from "moment";
---

<Container bg={styles.bg2}>
    <div class="flex flex-col py-20 gap-10 px-5 2xl:px-0">
        <div class="">
            <h2
                class={`text-xl font-bold tracking-tight ${styles.text} sm:text-2xl`}
            >
                Posts mentioning {name}
            </h2>
        </div>
        <div
            class="mx-auto mt-16 grid max-w-2xl auto-rows-fr grid-cols-1 gap-8 sm:mt-10 lg:mx-0 lg:max-w-none lg:grid-cols-3"
        >
            {
                posts.map((post) => (
                    <article
                        class={`relative isolate flex flex-col justify-end overflow-hidden rounded-2xl transition ease-in-out delay-150 hover:-translate-y-2 duration-300 ${styles.bg} px-8 pb-8 pt-80 sm:pt-48 lg:pt-80`}
                    >
                        <img
                            src={
                                post.posts_id.image !== null &&
                                post.posts_id.image.id !== null
                                    ? `https://unltd.directus.app/assets/${post.posts_id.image.id}`
                                    : `/img/blog/${slugify(post.posts_id.tag, { lower: true, strict: true, locale: "en", trim: true })}.webp`
                            }
                            alt=""
                            class="absolute inset-0 -z-10 h-full w-full object-cover"
                        />
                        <div
                            class={`absolute inset-0 -z-10 bg-gradient-to-t ${styles.gradient}`}
                        />
                        <div
                            class={`absolute inset-0 -z-10 rounded-2xl ring-1 ring-inset ${styles.ring}`}
                        />

                        <div class="flex flex-wrap items-center gap-4 overflow-hidden text-sm leading-6 text-gray-300">
                            <time
                                datetime={post.posts_id.date_time}
                                class={`${styles.text2}`}
                            >
                                {moment(post.posts_id.date_time).format(
                                    "ddd hh:mm, DD MMM YYYY",
                                )}
                            </time>
                            <div
                                class={`flex gap-x-2.5 font-bold ${styles.text2}`}
                            >
                                {post.posts_id.tag}
                            </div>
                        </div>
                        <h3
                            class={`mt-3 text-lg font-semibold leading-6 ${styles.text}`}
                        >
                            <a href={`/blog/${post.posts_id.slug}`}>
                                <span class="absolute inset-0" />
                                {post.posts_id.title}
                            </a>
                        </h3>
                    </article>
                ))
            }
        </div>
    </div>

    <!-- <div class="flex flex-col gap-3">
    <h3 class={`font-bold ${styles[programme.name].text}`}>Related posts</h3>
    <article
        class={`relative isolate flex flex-col justify-end overflow-hidden rounded-2xl ${styles[programme.name].bg} px-8 pb-8 pt-80 sm:pt-48 lg:pt-80`}
    >
        <img
            src={programme.post.image}
            alt=""
            class="absolute inset-0 -z-10 h-full w-full object-cover"
        />
        <div class={`absolute inset-0 -z-10 ${styles[programme.name].bg}`}>
        </div>
        <div class="absolute inset-0 -z-10 rounded-2xl"></div>

        <div
            class={`flex flex-wrap items-center gap-y-1 overflow-hidden text-sm leading-6 ${styles[programme.name].text}`}
        >
            <div class="-ml-4 flex items-center gap-x-4">
                <svg
                    viewBox="0 0 2 2"
                    class="-ml-0.5 h-0.5 w-0.5 flex-none fill-white/50"
                >
                    <circle cx="1" cy="1" r="1"></circle>
                </svg>
                <div class="flex gap-x-2.5">
                    By {programme.post.author}
                </div>
            </div>
        </div>
        <h3 class="mt-3 text-lg font-semibold leading-6 text-white">
            <a href={programme.post.link}>
                <span class="absolute inset-0"></span>
                {programme.post.title}
            </a>
        </h3>
    </article>
</div> -->
</Container>
