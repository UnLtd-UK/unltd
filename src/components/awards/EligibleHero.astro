---
/**
 * EligibleHero Component
 * Success hero section for the eligibility confirmation page
 */

import Icon from "@components/Icon.astro";
import Award from "@components/awards/Award.astro";
import RoundButton from "@components/awards/RoundButtonWrapper.astro";

interface Props {
    awards: any[];
    page: {
        tradingDescription: string;
    };
    isRoundOpen: boolean;
    nextOpenDate: string;
    showAwards?: boolean;
}

const {
    awards,
    page,
    isRoundOpen,
    nextOpenDate,
    showAwards = true,
} = Astro.props;

const isMultipleAwards = awards.length > 1;
const awardText = isMultipleAwards ? "Awards" : "Award";
---

<section
    x-data="{ email: new URLSearchParams(window.location.search).get('email') }"
>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div
            class="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-8 lg:gap-12"
        >
            <!-- Left: Confirmation Text & Apply Button -->
            <div class="flex-1 lg:max-w-xl">
                <div class="flex items-center gap-4 mb-4">
                    <div
                        class="w-16 h-16 rounded-2xl bg-white/20 flex items-center justify-center"
                    >
                        <Icon
                            name="circle-check"
                            style="solid"
                            class="text-3xl"
                        />
                    </div>
                    <span
                        class="inline-flex items-center rounded-full bg-white/20 px-3 py-1 text-sm font-semibold ring-1 ring-white/30"
                    >
                        <Icon
                            name="sparkles"
                            style="solid"
                            class="mr-1.5 text-xs"
                        />
                        Eligibility Confirmed
                    </span>
                </div>

                <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-4">
                    You're eligible to apply for {
                        isMultipleAwards ? awards.length : "a"
                    }
                    {awardText}
                </h1>

                <p class="text-lg text-emerald-100 mb-6">
                    {page.tradingDescription}, which means you can apply for {
                        isMultipleAwards
                            ? "either of these Awards"
                            : "this Award"
                    }.
                </p>

                <!-- Info notices -->
                <div class="flex flex-col gap-3 mb-6">
                    <!-- Email confirmation (client-side) -->
                    <div
                        x-show="email"
                        x-cloak
                        class="flex items-start gap-3 bg-white/10 rounded-lg px-4 py-3 ring-1 ring-white/20"
                    >
                        <Icon
                            name="envelope-circle-check"
                            style="solid"
                            class="text-emerald-200 mt-0.5"
                        />
                        <div>
                            <p class="text-sm text-white">
                                We've emailed <span
                                    x-text="email"
                                    class="font-semibold"></span> a link to this page
                            </p>
                        </div>
                    </div>

                    {
                        isMultipleAwards && (
                            <div class="flex items-start gap-3 bg-white/10 rounded-lg px-4 py-3 ring-1 ring-white/20">
                                <Icon
                                    name="info-circle"
                                    style="solid"
                                    class="text-emerald-200 mt-0.5"
                                />
                                <p class="text-sm text-white">
                                    You can only apply for one Award at a time.
                                    Choose the programme that best fits your
                                    needs.
                                </p>
                            </div>
                        )
                    }
                </div>

                <div class="mt-6">
                    <RoundButton
                        isRoundOpen={isRoundOpen}
                        nextOpenDate={nextOpenDate}
                    />
                </div>
            </div>

            <!-- Right: Award Cards (optional) -->
            {
                showAwards && (
                    <div class="shrink-0 w-full lg:w-auto">
                        <div class="grid grid-cols-1 gap-4">
                            {awards.map((award) => (
                                <div class="w-full">
                                    <Award {...award} />
                                </div>
                            ))}
                            {awards.length === 1 && (
                                <div class="w-full">
                                    <div class="h-full min-h-32 rounded-4xl border-2 border-dashed border-white/20 bg-white/5 flex flex-col items-center justify-center text-center p-6">
                                        <div class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center mb-4">
                                            <Icon
                                                name="question"
                                                style="solid"
                                                class="text-xl text-white/30"
                                            />
                                        </div>
                                        <p class="text-sm text-white/40 font-medium mb-2">
                                            Other Awards
                                        </p>
                                        <p class="text-xs text-white/30">
                                            Additional Awards may be available
                                            based on your eligibility
                                        </p>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                )
            }
        </div>
    </div>
</section>
